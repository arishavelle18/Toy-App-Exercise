<style>
.card-img-top {
    width: 100%;
    height: 15vw;
    object-fit: cover;
}
</style>

<% provide(:title,"Profile") %>
<h1 class="mb-4">Profile</h1>
<p>Name: <%= @user.name %></p>
<p>Email: <%= @user.email %></p>
<% if @users != 0%>
<%= link_to "New Micropost",profile_post_path, :class => "btn btn-success"%><br><br>
<%end%>

<div class="container">
  <div class="row g-3">
  <% @microposts.each do |micropost| %>
        <div class="col-12 col-md-6 col-lg-4">
            <div class="card">
                     <% if micropost.image.content_type.in?(%w[image/jpeg image/png]) %>
                        <% if micropost.image.attached? %>
                            <%= link_to image_tag(micropost.image_as_thumbnail,:class=>'card-img-top'),micropost.image_as_thumbnail %>
                        <% end %>
                        <% else %>
                            <%= link_to image_tag("no.jpg",alt:"No Logo",width:"300px",:class=>'card-img-top'),image_url('no.jpg') %>
                        <% end %>
                        <div class="accordion accordion-flush" id="accordionFlushExample">
              <div class="accordion-item ">
                <h2 class="accordion-header" id="flush-headingOne">
                  <button class="accordion-button collapsed " type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseOne<%= micropost.id%>" aria-expanded="false" aria-controls="flush-collapseOne">
                    <strong class="text-center"> <%= micropost.title %></strong
                  </button>
                </h2>
                    <div id="flush-collapseOne<%= micropost.id%>" class="accordion-collapse collapse" aria-labelledby="flush-headingOne" data-bs-parent="#accordionFlushExample">
                      <div class="accordion-body">
                                <div class="card-body">
                                        <h5 class="card-title">Title: <%= micropost.title %></h5>
                                        <p><%= micropost.content %></p>
                                        <p>Posted by: <%= micropost.user.name %></p>
                                        <p>Created: <%= time_ago_in_words(micropost.created_at) %> ago</p>
                                            <% #link_to "Show",micropost_path(micropost),:class => "btn btn-primary"%>
                                        <% if Current.user.id == micropost.user_id %>
                                            <%= link_to "Edit",edit_micropost_path(micropost),:class => "btn btn-secondary"%>
                                            <%= link_to 'Destroy',micropost_delete_path(micropost), method: :delete, :onclick => "return confirm('Are you sure you want to delete this post?')" ,:class => "btn btn-danger" %>
                                        <% end %>
                                  </div>
                      </div>
                    </div>
              </div>
              
            </div>
                   
            </div>
        </div>
     <% end %>
     <% if not @microposts.exists? %>
        <h3 class="text-center">Data not found</h3>
     <% end %>
    </div>
</div>